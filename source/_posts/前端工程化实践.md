---
title: ä»£ç è§„èŒƒæœ€ä½³å®è·µ
date: 2022-04-28 15:17:32
tags:
  - å‰ç«¯å·¥ç¨‹åŒ–
---

# eslint 

- `npm i eslint -D` ä¸‹è½½eslintï¼Œ`npx eslint --init`åˆå§‹åŒ–eslintï¼Œæ ¹æ®è‡ªå·±çš„æƒ³æ³•æ¥é€‰æ‹©å¯¹åº”çš„é€‰é¡¹ï¼Œè¿™é‡Œæˆ‘æ˜¯ä½¿ç”¨çš„`eslint:recommended`è¿™ä¸ªextends
- è‡ªè¡ŒæŸ¥é˜…eslint:recommendedçš„[è§„åˆ™](https://eslint.org/docs/rules/)ï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚åœ¨`rules`å­—æ®µé‡Œé¢è¿›ä¸€æ­¥å®šåˆ¶åŒ–ã€‚
<!-- more -->
# prettier

- ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº†eslintæ¥è¿›è¡Œé”™è¯¯çš„æ£€æµ‹ä»¥åŠä¿®æ­£é”™è¯¯ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨prettieræ¥è¿›è¡Œä»£ç çš„æ ¼å¼çš„ç¾åŒ–

- å› ä¸ºeslintå’Œprettierçš„æœ‰äº›è§„åˆ™ä¼šå‘ç”Ÿå†²çªï¼Œæˆ‘ä»¬ä½¿ç”¨[eslint-config-prettier](https://github.com/prettier/eslint-config-prettier)å…³é—­æ‰€æœ‰ä¸å¿…è¦æˆ–å¯èƒ½ä¸[Prettier](https://github.com/prettier/prettier)å†²çªçš„è§„åˆ™,è¯·æ³¨æ„ï¼Œæ­¤é…ç½®ä»…å…³é—­è§„åˆ™ï¼Œä»…æ£€æµ‹eslinté…ç½®æ–‡ä»¶ä¸­`rules`å­—æ®µé‡Œé¢å®šä¹‰çš„è§„åˆ™

- `npm i eslint-config-prettier -D `  `npm install --save-dev --save-exact prettier`

  ```js
  //.eslintrc.js
  module.exports = {
      extends: [
          //ä½ çš„å…¶ä»–extends
          'prettier'],
  }
  ```

  

  **æ£€æµ‹å†²çª**

  - `npx eslint-config-prettier path/to/main.js`  ï¼ŒæŠŠ`path/to/main.js` æ›¿æ¢æˆä»¥åŠå­˜åœ¨çš„jsæ–‡ä»¶å³å¯ï¼Œåªéœ€æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶å³å¯

- åˆ›å»º`.prettierrc.js`æ–‡ä»¶ï¼Œåœ¨é‡Œé¢é…ç½®ç›¸åº”çš„optionï¼Œå…·ä½“çš„é…ç½®æ–‡ä»¶é€‰é¡¹å’Œoptionä»¥åŠé»˜è®¤å€¼è¯·æŸ¥é˜…[option](https://prettier.io/docs/en/options.html)    [é…ç½®æ–‡ä»¶](https://prettier.io/docs/en/configuration.html)

  è¿™é‡Œç»™å‡ºä¸€äº›`.prettierrc.js`çš„é…ç½®


# stylelintè§„èŒƒcss

- `npm install --save-dev stylelint stylelint-config-standard stylelint-config-prettier`

- å› ä¸ºæˆ‘ä»¬é¡¹ç›®ä¸­ä½¿ç”¨äº†`prettier` ï¼Œå› æ­¤prettierå¯èƒ½ä¼šä¸stylelintçš„ä¸€äº›é…ç½®äº§ç”Ÿå†²çªï¼Œæˆ‘ä»¬å®‰è£…`stylelint-config-prettier`æ¥é¿å…å†²çª

- æˆ‘ä»¬ä½¿ç”¨[stylelint-config-rational-order](https://github.com/constverum/stylelint-config-rational-order)æ¥è§„èŒƒcssçš„é¡ºåºï¼Œ`npm install --save-dev  stylelint-order stylelint-config-rational-order`ï¼Œå…·ä½“çš„é¡ºåºè¯·æŸ¥çœ‹å®˜ç½‘

- ä½¿ç”¨[stylelint-selector-no-empty](https://github.com/ssivanatarajan/stylelint-selector-no-empty)æ¥ç¦æ­¢ç©ºçš„é€‰æ‹©å™¨ï¼Œ `npm install stylelint-selector-no-empty --save-dev`

- æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯lessï¼Œè¦å®‰è£…`postcss-less`æ¥lint lessæ–‡ä»¶ï¼Œä½¿ç”¨stylelint æ¥lint `*.less`æ–‡ä»¶æ—¶ï¼Œä¹Ÿè¦åŠ ä¸Š`--custom-syntax postcss-less`,ä¾‹å¦‚ï¼š

  ```bash
    "scripts": {
      "lint:css": "stylelint *.less src/*.less --fix  --custom-syntax postcss-less"
    },
  ```

- å¦‚æœä½ ä½¿ç”¨çš„æ˜¯scssï¼Œå¯ä»¥ä½¿ç”¨[stylelint-scss](https://github.com/stylelint-scss/stylelint-scss),å…·ä½“æ€ä¹ˆä½¿ç”¨å®˜æ–¹å‚è€ƒæ–‡æ¡£

- ä¸‹é¢æ˜¯æˆ‘çš„`.stylelintrc.js`çš„é…ç½®

```js
//.stylelintrc.js
module.exports = {
  extends: [
    "stylelint-config-standard",
    "stylelint-config-prettier",
    // stylelint-config-rational-orderé‡Œé¢å†…ç½®äº†ä¸€å¥—cssçš„é¡ºåºï¼Œå› æ­¤æˆ‘ä»¬ä¸‹é¢å¯ä»¥ä¸ç”¨è‡ªå®šä¹‰order/properties-orderäº†,å½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå·±é…ç½®
    "stylelint-config-rational-order",
  ],
  plugins: [
    "stylelint-selector-no-empty",
    // å› ä¸ºä¸Šé¢ä½¿ç”¨äº†stylelint-config-rational-orderï¼Œé‡Œé¢å·²ç»æ·»åŠ äº†stylelint-order
    // "stylelint-order",
  ],
  rules: {
    // ç¦æ­¢ç©ºé€‰æ‹©å™¨
    "plugin/stylelint-selector-no-empty": true,
    "order/order": [
      // æ’åº css è‡ªå®šä¹‰å˜é‡ --variable åˆ—åœ¨æœ€å‰è¾¹
      ["custom-properties", "declarations"],
      {
        disableFix: true,
      },
    ],
    // "order/properties-order":[
    //     "position",
    //     "top",
    //     "right",
    //     "bottom",
    //     "left",
    //     "z-index",
    //     "display",
    //     "float",
    //     "width",
    //     "height"
    // ]
  },
}
```

# è§„èŒƒcommit

- ä½¿ç”¨[commitizen](https://www.npmjs.com/package/commitizen)æ¥è§„èŒƒcommitçš„æäº¤

  `npm install  -D commitizen` 

  `commitizen init cz-conventional-changelog --save-dev --save-exact`

- ä¹‹åå¯ä»¥ä½¿ç”¨`npx cz` æˆ–è€…`git cz` æ¥commit

# lint-stagedæ¥ç­›é€‰æäº¤çš„æ–‡ä»¶

- ä½¿ç”¨[lint-staged ](https://github.com/okonet/lint-staged)æœ€ç®€å•çš„æ–¹æ³•æ˜¯`npx mrm@2 lint-staged`,ä»–ä¼šæ ¹æ®ä½ ä¸Šé¢é…ç½®çš„eslintï¼Œprettierç­‰æ¥å¸®ä½ å®‰è£…[husky](husky)è‡ªåŠ¨è¿›è¡Œé…ç½®,ç„¶åè¿›è¡Œé…ç½®,åœ¨package.jsonä¸­ä¼šç”Ÿæˆä¸‹é¢çš„é…ç½®æ–‡ä»¶ï¼Œä¸è¿‡è¿™é‡Œæœ‰ç‚¹é—®é¢˜ï¼Œè¿™é‡Œéœ€è¦æŠŠ`"postcss-less":"stylelint --fix",`è¿™ä¸€è¡Œæ¢æˆ`"*.less": "stylelint --fix --custom-syntax postcss-less",`å³å¯ã€‚

  ```json
    "lint-staged": {
      "*.js": "eslint  --fix",
      //"*.less": "stylelint --fix --custom-syntax postcss-less",
      "postcss-less":"stylelint --fix",
      "*.{js,css,md}": "prettier --write"
    }
  ```

- ![image-20220428121352410](https://leftover-md.oss-cn-guangzhou.aliyuncs.com/img-md/image-20220428121352410.png)

- è¿™é‡Œä»–ç”Ÿæˆäº†ä¸€ä¸ª`.husky`æ–‡ä»¶ï¼Œå½“ä½ è¿›è¡Œcommitçš„æ—¶å€™ï¼Œä»–ä¼šæ‰§è¡Œ`npx lint-staged`å‘½ä»¤ï¼Œä¹‹åä¼šæ ¹æ®`package.json`æ–‡ä»¶ä¸­çš„lint-stageé…ç½®é¡¹è¿›è¡Œç­›é€‰æäº¤çš„æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œå¯¹åº”çš„å‘½ä»¤ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯æˆ‘ä»¬æ¯æ¬¡æäº¤ä¹‹å‰éƒ½å¯¹æ–‡ä»¶è¿›è¡Œæ ¼å¼åŒ–

# ç­›é€‰è§„èŒƒçš„commit

- å°½ç®¡æˆ‘ä»¬ä¸Šé¢å·²ç»ä½¿ç”¨äº†`commitizen` æ¥è§„èŒƒcommitï¼Œä½†æ˜¯å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨`npx cz` æˆ–è€…`git cz` æ¥æäº¤commit ,è€Œæ˜¯ç›´æ¥ä½¿ç”¨`git commit` æ¥æäº¤ï¼Œä¹Ÿæ˜¯èƒ½æäº¤ä¸Šå»ï¼Œè¿™æ ·å°±æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰äº†ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨[commitlint](https://github.com/conventional-changelog/commitlint#getting-started) æ¥æ£€æŸ¥æäº¤çš„commitï¼Œå½“ä½ æäº¤äº†ä¸è§„èŒƒçš„commitæ—¶ï¼Œä»–ä¼šé˜»æ­¢è¿™æ¬¡æäº¤


  ![image-20220428141616365](https://leftover-md.oss-cn-guangzhou.aliyuncs.com/img-md/image-20220428141616365.png)

 ```
  npm install --save-dev @commitlint/config-conventional @commitlint/cli
  echo "module.exports = {extends: ['@commitlint/config-conventional']}" > commitlint.config.js
 ```

- åœ¨.huskyæ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»ºä¸€ä¸ªcommit-msgæ–‡ä»¶,å¢æ·»ä»¥ä¸‹å†…å®¹ï¼Œ

```bash

#!/bin/sh
. "$(dirname "$0")/_/husky.sh"
npx --no -- commitlint --edit $1

```

ä¹‹åä½ çš„æ¯æ¬¡æäº¤éƒ½ä¼šæ£€æµ‹commitæ˜¯å¦è§„èŒƒ

- åœ¨é¡¹ç›®ä¸‹é¢åˆ›å»º`.prettierignore` ,`.eslintignore`æ–‡ä»¶ï¼Œåœ¨è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­åˆ†åˆ«æ·»åŠ 

  ```
  commitlint.config.js
  ```

- ä¸ç„¶eslintæ ¼å¼åŒ–çš„æ—¶å€™ä¼šæŠ¥é”™

# å»ºè®®

1. ä»¥ä¸Šå†…å®¹å‡åªåœ¨nodeç¯å¢ƒä¸‹å®éªŒï¼Œåé¢ä¼šé™†ç»­æ›´æ–°vueçš„é…ç½®ï¼Œä½†æ˜¯å¤§ä½“ä¸Šéƒ½å·®ä¸å¤šï¼Œä¼šå¤šç”¨åˆ°ä¸€äº›eslintæˆ–è€…prettierçš„pluginï¼Œå…¶ä»–å†…å®¹åŸºæœ¬æ²¡ä»€ä¹ˆåŒºåˆ«
2. è¿™ç¯‡æ–‡ç« åªæ˜¯ç»™ä½ æŒ‡å¼•ä¸€ä¸ªæ–¹å‘ï¼Œæ–‡ç« é‡Œæåˆ°çš„é‚£äº›ä¸œè¥¿éƒ½ç»™å‡ºäº†ç›¸åº”çš„é“¾æ¥ï¼Œå¸Œæœ›å¤§å®¶å¤šçœ‹å®˜ç½‘ï¼Œè‡ªå·±å¤šå®è·µä¸€ä¸‹

å¦‚æœå–œæ¬¢çš„è¯ï¼Œé‚£å°±ç‚¹ä¸ªèµå­ğŸ¤















